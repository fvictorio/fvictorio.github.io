<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    

    
        <title>
             You and Your Shell
            
        </title>

        
            <meta property="og:title" content="You and Your Shell" />
        
    

    
        
            <meta property="og:description" content="What is a shell? Baby don&#x27;t glob me." />
        
    

    
        
            <meta name="description" content="What is a shell? Baby don&#x27;t glob me." />
        
    

    
         <link rel="icon" type="image/png" href=&#x2F;icon&#x2F;favicon.png />
    

    

    
        <!-- Global site tag (gtag.js) - Google Analytics -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-7N26802D9C"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());

            gtag('config', 'G-7N26802D9C');
        </script>
    

    
    
        <script src=https://fvictorio.github.io/js/feather.min.js></script>
    


    
        <link href=https://fvictorio.github.io/css/fonts.css rel="stylesheet" />
    

    <link rel="stylesheet" type="text/css" media="screen" href=https://fvictorio.github.io/css/main.css />

    
        <link
            rel="stylesheet"
            id="darkModeStyle"
            type="text/css"
            href=https://fvictorio.github.io/css/dark.css
            
            
                disabled
            
        />
    


    


</head>


<body>
    <div class="content">
        <header>
    <div class="main" id="main_title">
        <a href=https:&#x2F;&#x2F;fvictorio.github.io&#x2F;>Whales are Fishes</a>
    </div>

    <nav>
        
            <a href=&#x2F;>Home</a>
        
            <a href=&#x2F;posts>All posts</a>
        
            <a href=&#x2F;about>About</a>
        

        

        
            | <a id="dark-mode-toggle" onclick="toggleTheme()" href=""></a>
            <script src=https://fvictorio.github.io/js/themetoggle.js></script>
        
    </nav>
</header>


        
    
<main>
    <article>
        <div class="title">
            <h1 class="title">You and Your Shell</h1>
            <div class="meta">
                
                
                    on  2023-09-24
                

                
            </div>
        </div>

        

        <section class="body">
            <p>This article is my attempt to explain what is a shell and what it does. My goal is for you to build a useful mental model of what's going on under the hood when you open a terminal, paste some command, and hope that it doesn't erase all your terrible, embarrasing, hidden sci-fi poems.</p>
<h1 id="is-this-for-you">Is this for you?</h1>
<p>I think you won't get much from this article if you can answer these questions without even blinking:</p>
<ul>
<li>What is the difference between <code>echo foo</code> and <code>echo 'foo'</code>?</li>
<li>What's going on when you do <code>DEBUG='*' some-command</code></li>
<li>What's the difference between a program and a shell built-in? Why do we have both?</li>
</ul>
<p>But you may still want to jump directly to <a href="https://fvictorio.github.io/posts/you-and-your-shell/#examples">the examples</a>. If you find any of them surprising, then maybe there's something useful for you here!</p>
<h1 id="contents">Contents</h1>
<ul>
<li><a href="https://fvictorio.github.io/posts/you-and-your-shell/#what-is-a-shell">What is a shell?</a>
<ul>
<li><a href="https://fvictorio.github.io/posts/you-and-your-shell/#running-programs">Running programs</a></li>
<li><a href="https://fvictorio.github.io/posts/you-and-your-shell/#the-worst-shell-in-the-world">The worst shell in the world</a></li>
<li><a href="https://fvictorio.github.io/posts/you-and-your-shell/#finding-programs">Finding programs</a></li>
<li><a href="https://fvictorio.github.io/posts/you-and-your-shell/#parsing-arguments">Parsing arguments</a></li>
<li><a href="https://fvictorio.github.io/posts/you-and-your-shell/#globs">Globs</a></li>
<li><a href="https://fvictorio.github.io/posts/you-and-your-shell/#quotes">Quotes</a></li>
<li><a href="https://fvictorio.github.io/posts/you-and-your-shell/#environment-variables">Environment variables</a></li>
<li><a href="https://fvictorio.github.io/posts/you-and-your-shell/#built-in-commands">Built-in commands</a></li>
</ul>
</li>
<li><a href="https://fvictorio.github.io/posts/you-and-your-shell/#examples">Examples!</a>
<ul>
<li><a href="https://fvictorio.github.io/posts/you-and-your-shell/#example-1-the-separator">Example 1: The <code>--</code> separator</a></li>
<li><a href="https://fvictorio.github.io/posts/you-and-your-shell/#example-2-escaping-quotes">Example 2: Escaping quotes</a></li>
<li><a href="https://fvictorio.github.io/posts/you-and-your-shell/#example-3-conditions-in-bash-programming">Example 3: Conditions in bash programming</a></li>
</ul>
</li>
<li><a href="https://fvictorio.github.io/posts/you-and-your-shell/#clarifications">Clarifications</a></li>
<li><a href="https://fvictorio.github.io/posts/you-and-your-shell/#further-reading">Further reading</a></li>
</ul>
<h1 id="what-is-a-shell">What is a shell?</h1>
<p>My favorite definition comes from the classic <a href="https://en.wikipedia.org/wiki/The_Unix_Programming_Environment">The UNIX Programming Environment</a>:</p>
<blockquote>
<p>[The shell is] the program that interprets your requests to run programs.</p>
</blockquote>
<p>This short sentence tells us a lot:</p>
<ul>
<li>First, a shell is just a program. <code>bash</code>, <code>zsh</code> and <code>fish</code> are all different programs that function as shells.</li>
<li>Second, a shell interprets requests. You use a specific language for these requests, even if you are not aware of it.</li>
<li>Finally, a shell is used to run programs. You can do other things with it, but that's its main purpose.</li>
</ul>
<p>Let's explore this definition in more detail.</p>
<h2 id="running-programs">Running programs</h2>
<p>The first thing we need to understand is that a program is always started from another program.<sup class="footnote-reference"><a href="#1">1</a></sup> Who started that other program, you might ask? Well, of course: a third program. And who started that one? Yet another program. But who...? I don't know, <a href="https://en.wikipedia.org/wiki/Init">a turtle or something</a>.</p>
<p>The details of what exactly a program does to start another one are not relevant for our purposes. We can just assume that there is a function that looks like this:</p>
<pre data-lang="typescript" style="background-color:#383838;color:#e6e1dc;" class="language-typescript "><code class="language-typescript" data-lang="typescript"><span style="font-style:italic;color:#6e9cbe;">function </span><span style="color:#ffc66d;">runProgram</span><span>(
</span><span>  </span><span style="font-style:italic;color:#fd971f;">pathToProgram</span><span style="color:#cc7833;">: </span><span style="font-style:italic;color:#6e9cbe;">string</span><span>,
</span><span>  </span><span style="font-style:italic;color:#fd971f;">arguments</span><span style="color:#cc7833;">: </span><span style="font-style:italic;color:#6e9cbe;">string</span><span>[],
</span><span>  </span><span style="font-style:italic;color:#fd971f;">environmentVariables</span><span style="color:#cc7833;">?: </span><span>Record&lt;</span><span style="font-style:italic;color:#6e9cbe;">string</span><span>, </span><span style="font-style:italic;color:#6e9cbe;">string</span><span>&gt;
</span><span>)
</span></code></pre>
<p>This is a crude simplification, but it will do. At its core, starting a program requires its path in the filesystem and a list of arguments. We can also optionally pass a dictionary of environment variables.</p>
<p>With this function and our previous definition, we can try to write a very simple and useless shell.</p>
<h2 id="the-worst-shell-in-the-world">The worst shell in the world</h2>
<p>Since we defined a shell as a program that interprets requests to run programs and assumed we have a <code>runProgram</code> function, we can write an extremely simple shell that just runs whatever program is passed to it:</p>
<pre data-lang="typescript" style="background-color:#383838;color:#e6e1dc;" class="language-typescript "><code class="language-typescript" data-lang="typescript"><span style="color:#cc7833;">while </span><span>(</span><span style="color:#6e9cbe;">true</span><span>) {
</span><span>  </span><span style="font-style:italic;color:#6e9cbe;">const </span><span style="color:#da4939;">pathToProgram </span><span style="color:#cc7833;">= </span><span style="color:#ffc66d;">readLine</span><span>();
</span><span>  </span><span style="color:#ffc66d;">runProgram</span><span>(</span><span style="color:#d0d0ff;">pathToProgram</span><span>, []);
</span><span>}
</span></code></pre>
<p>This would be extremely useless, but it does the job. You input a path to the program you want to run, our shitty shell interprets your request verbatim, and that's it. But a real shell does much more than that.</p>
<h2 id="finding-programs">Finding programs</h2>
<p>When you want to run the <code>df</code> program to see if you have enough space to keep <del>downloading</del> buying movies, you don't write <code>/usr/bin/df</code>, you just write <code>df</code>. This wouldn't work on our dumb implementation, but it does in any real shell.</p>
<p>The reason this works is that the shell will check a list of pre-defined directories to see if any of them contains a program with that name. You probably already know that this list is in the <a href="https://en.wikipedia.org/wiki/PATH_(variable)"><code>PATH</code> environment variable</a>. We can easily add this feature to our previous snippet, especially if we assume that we have more magic functions available:</p>
<pre data-lang="typescript" style="background-color:#383838;color:#e6e1dc;" class="language-typescript "><code class="language-typescript" data-lang="typescript"><span style="color:#cc7833;">while </span><span>(</span><span style="color:#6e9cbe;">true</span><span>) {
</span><span>  </span><span style="font-style:italic;color:#6e9cbe;">const </span><span style="color:#da4939;">program </span><span style="color:#cc7833;">= </span><span style="color:#ffc66d;">readLine</span><span>();
</span><span>  </span><span style="font-style:italic;color:#6e9cbe;">const </span><span style="color:#da4939;">pathToProgram </span><span style="color:#cc7833;">= </span><span style="color:#ffc66d;">findProgram</span><span>(process.env.</span><span style="color:#da4939;">PATH</span><span>, </span><span style="color:#d0d0ff;">program</span><span>);
</span><span>
</span><span>  </span><span style="color:#cc7833;">if </span><span>(</span><span style="color:#d0d0ff;">pathToProgram</span><span>) {
</span><span>      </span><span style="color:#ffc66d;">runProgram</span><span>(</span><span style="color:#d0d0ff;">pathToProgram</span><span>, []);
</span><span>  } </span><span style="color:#cc7833;">else </span><span>{
</span><span>      </span><span style="font-style:italic;color:#6e9cbe;">console</span><span>.</span><span style="color:#da4939;">error</span><span>(</span><span style="color:#a5c261;">`No program named &#39;${</span><span style="color:#d0d0ff;">program</span><span style="color:#a5c261;">}&#39; was found`</span><span>);
</span><span>  }
</span><span>}
</span></code></pre>
<p><em>Now</em> we are doing some interpretation.</p>
<p>But what if we want to pass some arguments to a program? If we run <code>rm Titanic.mkv</code> we'll get this:</p>
<pre style="background-color:#383838;color:#e6e1dc;"><code><span>No program named &#39;rm Titanic.mkv&#39; was found
</span></code></pre>
<p>Which makes sense! We are taking the full line and interpreting it as a program name. Whitespace is not special, and neither are you.</p>
<p>What we need here is some more of that sweet <em>interpretation</em>.</p>
<h2 id="parsing-arguments">Parsing arguments</h2>
<p>Let's update our shell to interpret whitespace as a separator between the name of the program and the arguments:</p>
<pre data-lang="typescript" style="background-color:#383838;color:#e6e1dc;" class="language-typescript "><code class="language-typescript" data-lang="typescript"><span style="color:#cc7833;">while </span><span>(</span><span style="color:#6e9cbe;">true</span><span>) {
</span><span>  </span><span style="font-style:italic;color:#6e9cbe;">const </span><span style="color:#da4939;">line </span><span style="color:#cc7833;">= </span><span style="color:#ffc66d;">readLine</span><span>();
</span><span>
</span><span>  </span><span style="font-style:italic;color:#6e9cbe;">const </span><span>[</span><span style="color:#da4939;">program</span><span>, </span><span style="color:#cc7833;">...</span><span style="color:#da4939;">args</span><span>] </span><span style="color:#cc7833;">= </span><span style="color:#d0d0ff;">line</span><span>.</span><span style="color:#da4939;">split</span><span>(</span><span style="color:#a5c261;">/</span><span style="color:#6d9cbe;">\s</span><span style="color:#cc7833;">+</span><span style="color:#a5c261;">/</span><span style="color:#cc7833;">g</span><span>);
</span><span>
</span><span>  </span><span style="font-style:italic;color:#6e9cbe;">const </span><span style="color:#da4939;">pathToProgram </span><span style="color:#cc7833;">= </span><span style="color:#ffc66d;">findProgram</span><span>(process.env.</span><span style="color:#da4939;">PATH</span><span>, </span><span style="color:#d0d0ff;">program</span><span>);
</span><span>  </span><span style="color:#cc7833;">if </span><span>(</span><span style="color:#d0d0ff;">pathToProgram</span><span>) {
</span><span>      </span><span style="color:#ffc66d;">runProgram</span><span>(</span><span style="color:#d0d0ff;">pathToProgram</span><span>, </span><span style="color:#d0d0ff;">args</span><span>);
</span><span>  } </span><span style="color:#cc7833;">else </span><span>{
</span><span>      </span><span style="font-style:italic;color:#6e9cbe;">console</span><span>.</span><span style="color:#da4939;">error</span><span>(</span><span style="color:#a5c261;">`No program named &#39;${</span><span style="color:#d0d0ff;">program</span><span style="color:#a5c261;">}&#39; was found`</span><span>);
</span><span>  }
</span><span>}
</span></code></pre>
<p>If this code actually worked and we ran <code>rm Titanic.mkv</code> on it, it would actually delete the file. Probably. In any case, the takeaway is that we are doing a more complex interpretation of the command we receive. The command is still just a string, but we are starting to parse it in a somewhat interesting way.</p>
<h2 id="globs">Globs</h2>
<p>What if you want to remove all the files that end in <code>.mkv</code> in a directory? It's easy with our shell: you just run <code>ls</code>, then write <code>rm </code>, and then manually add all the files that end with that extension. I'm sure you won't make any typos.</p>
<p>If you don't like typing, then there are some ways this could be automated. Maybe you could use a version of <code>rm</code> that, instead of a list of files, receives an extension as its argument and removes all the files with that extension. Or perhaps you could have one program that writes all the files with some extension to a file, and then pass that file to another program which consumes it and removes all the files pointed by it...</p>
<p>...or you could just add a new feature to the shell. You could say that, if the shell finds something like <code>*.mkv</code>, then it will interpret it as &quot;all the files in the current directory that end in <code>mkv</code>&quot;. This is called <a href="https://tldp.org/LDP/abs/html/globbingref.html">glob expansion or globbing</a>. <a href="https://en.wikipedia.org/wiki/Glob_(programming)">Globs</a> are like regular expressions, but worse, or better; it's hard to say.</p>
<p>The important part here, and probably the most important part of this article, is that <strong>this expansion is performed by the shell!</strong> This is quite easy to check by writing a program that just prints its arguments. With Node.js, you can do something like this:</p>
<pre data-lang="typescript" style="background-color:#383838;color:#e6e1dc;" class="language-typescript "><code class="language-typescript" data-lang="typescript"><span style="color:#95815e;">// index.js
</span><span style="font-style:italic;color:#6e9cbe;">const </span><span style="color:#da4939;">arguments </span><span style="color:#cc7833;">= </span><span>process.argv.</span><span style="color:#da4939;">slice</span><span>(</span><span style="color:#a5c261;">2</span><span>);
</span><span style="font-style:italic;color:#6e9cbe;">console</span><span>.</span><span style="color:#da4939;">log</span><span>(</span><span style="color:#86c20e;">JSON</span><span>.</span><span style="color:#da4939;">stringify</span><span>(</span><span style="color:#d0d0ff;">arguments</span><span>));
</span></code></pre>
<p>If you run <code>node index.js 1 2 foo</code>, you will get the list <code>[&quot;1&quot;,&quot;2&quot;,&quot;foo&quot;]</code>. (Don't pay too much attention to the <code>.slice(2)</code> part, this just avoids printing the paths to the node binary and the script, which are included in the arguments list for what I'm sure are very good reasons.)</p>
<p>If you now create some files:</p>
<pre data-lang="txt" style="background-color:#383838;color:#e6e1dc;" class="language-txt "><code class="language-txt" data-lang="txt"><span>$ touch a.txt b.txt c.txt
</span></code></pre>
<p>And then run <code>node index.js *.txt</code>, the program will print <code>[&quot;a.txt&quot;,&quot;b.txt&quot;,&quot;c.txt&quot;]</code>, not <code>[&quot;*.txt&quot;]</code>.</p>
<p>Things like <code>*</code> are called <strong>metacharacters</strong>. These are characters that receive a special treatment by the shell. There are a lot of these, like <code>?</code>, <code>|</code>, <code>&lt;</code> and <code>&gt;</code>.</p>
<p>But now you, being a smart and curious person, are wondering: &quot;what if I actually want to pass <code>*.txt</code> as an argument to a program, for my own devious purposes?&quot;.</p>
<h2 id="quotes">Quotes</h2>
<p>This is one of the things you might do without fully understanding. You run something in the shell; it doesn't work and you get a scary error message. You try adding some quotes. Now it works. Success! But what did actually happen?</p>
<p>Here I'm going to quote from <em>The UNIX Programming Environment</em> again.</p>
<blockquote>
<p>Given the number of shell metacharacters, there has to be some way to say to the shell, &quot;Leave it alone&quot;. The easiest and best way to protect special characters from being interpreted is to enclose them in single quote characters:</p>
<pre style="background-color:#383838;color:#e6e1dc;"><code><span>$ echo &#39;***&#39;
</span><span>***
</span><span>$
</span></code></pre>
</blockquote>
<p>Honestly, you should just close this tab and go read Chapter 3 from that book. It's so good.</p>
<p>But yes: you use single or double quotes to escape metacharacters. Single quotes escape everything, double quotes allows certain expansions within them. I think a good thumb of rule is &quot;always use single quotes unless you know what you're doing&quot;.</p>
<p>So, going back to the question in the previous section, if you want to literally pass <code>*.txt</code> as an argument to a program, you can do:</p>
<pre style="background-color:#383838;color:#e6e1dc;"><code><span>$ rm &#39;*.txt&#39;
</span></code></pre>
<p>And if you have a file that is literally named <code>*.txt</code> then 1) you are a monster and 2) it will be removed.</p>
<p>You can also try this with the little script we wrote before:</p>
<pre style="background-color:#383838;color:#e6e1dc;"><code><span>$ node index.js &#39;*.txt&#39;
</span><span>[&quot;*.txt&quot;]
</span></code></pre>
<h2 id="environment-variables">Environment variables</h2>
<p>So far, we've called our <code>runProgram</code> function without passing any environment variables. The default behavior in this case is that the environment of the parent process will be passed to the child process (or maybe some of them are changed? I'm fuzzy on the details here).</p>
<p>What if you want to run a program with some specific environment variables? Most shells let you do this with a special syntax. In bash/zsh/fish, for example, you can do:</p>
<pre style="background-color:#383838;color:#e6e1dc;"><code><span>$ FOO=1 BAR=2 program arg1 arg2
</span></code></pre>
<p>That is, you can prepend the program name with a list of environment variables. As before, it's easy to write a little script to test this out:</p>
<pre data-lang="typescript" style="background-color:#383838;color:#e6e1dc;" class="language-typescript "><code class="language-typescript" data-lang="typescript"><span style="color:#95815e;">// index.js
</span><span style="font-style:italic;color:#6e9cbe;">console</span><span>.</span><span style="color:#da4939;">log</span><span>(process.env.</span><span style="color:#da4939;">FOO</span><span>);
</span></code></pre>
<p>Running <code>node index.js</code> will print <code>undefined</code> but running <code>FOO=1 node index.js</code> will print <code>1</code>.</p>
<p>There is an alternative way to do this that you've surely seen before, but which is not exactly equivalent:</p>
<pre style="background-color:#383838;color:#e6e1dc;"><code><span>$ export FOO=1
</span><span>$ node index.js
</span><span>1
</span></code></pre>
<p>The difference here is that <code>export FOO=1</code> is modifying the environment of the shell, which is then passed down to our script. This is persistent: if we run <code>node index.js</code> a second time in the same shell session, it will print 1 again. But if we do that with the previous version (assuming a fresh shell instance), it won't:</p>
<pre style="background-color:#383838;color:#e6e1dc;"><code><span>$ FOO=1 node index.js
</span><span>1
</span><span>$ node index.js
</span><span>undefined
</span></code></pre>
<h2 id="built-in-commands">Built-in commands</h2>
<p>The most interesting part of the previous section is <code>export FOO=1</code>. This is an example of running a command in the shell that <em>doesn't</em> execute a program. <code>export</code> here is what's called a <em>built-in command</em> of the shell.</p>
<p>When you run things like <code>df</code>, <code>rm</code>, <code>vim</code> or whatever, there is an actual file in your disk with the code for that program. You can use <code>whereis</code> to find the path to that file:</p>
<pre style="background-color:#383838;color:#e6e1dc;"><code><span>$ whereis df
</span><span>df: /usr/bin/df /usr/share/man/man1/df.1.gz
</span></code></pre>
<p>But if you do the same with a built-in, you get a sad void:</p>
<pre style="background-color:#383838;color:#e6e1dc;"><code><span>$ whereis export
</span><span>export:
</span></code></pre>
<p>Why do we have built-ins? Why isn't everything a program?</p>
<p>In many cases, the reason is that the built-in does something that can't be done by a program. For example, <code>export</code> modifies the environment of the shell and <code>cd</code> changes its current directory. This is something that can't be done by a program, because a program can't make these modifications to its parent process.<sup class="footnote-reference"><a href="#2">2</a></sup></p>
<p>In any case, if you want to know if a command is a built-in or not, you can use the <code>type</code> command:</p>
<pre style="background-color:#383838;color:#e6e1dc;"><code><span>$ type export
</span><span>export is a shell builtin
</span></code></pre>
<p>Type is, of course, a builtin:</p>
<pre style="background-color:#383838;color:#e6e1dc;"><code><span>$ type type
</span><span>type is a shell builtin
</span></code></pre>
<h1 id="examples">Examples!</h1>
<p>Ok, now for the fun part. Let's use what we learned to explore some interesting examples.</p>
<h2 id="example-1-the-separator">Example 1: The <code>--</code> separator</h2>
<p>Let's start with an easy one. Sometimes you run a command that, in turn, runs another command. For example, let's say you are working on a Rust command line program. You can run it during development with <code>cargo run</code> and pass arguments to it.</p>
<pre style="background-color:#383838;color:#e6e1dc;"><code><span>cargo run someArg
</span></code></pre>
<p>In this case, your program will receive <code>someArg</code> as an argument.</p>
<p>Now imagine you added support for a new <code>--foo</code> flag and you want to try it out. If you do this:</p>
<pre style="background-color:#383838;color:#e6e1dc;"><code><span>$ cargo run --foo someArg
</span></code></pre>
<p>you'll get an error:</p>
<pre style="background-color:#383838;color:#e6e1dc;"><code><span>error: Found argument &#39;--foo&#39; which wasn&#39;t expected, or isn&#39;t valid in this context
</span><span>
</span><span>  If you tried to supply &#39;--foo&#39; as a value rather than a flag, use &#39;-- --foo&#39;
</span></code></pre>
<p>What's happening here is that cargo thinks that <code>--foo</code> is a flag for <code>cargo run</code>, not for your program. A similar thing happens when you do <code>npm run some-script</code> and want to pass some arguments to the command executed by the script.</p>
<p>In both cases, the solution is to add a <code>--</code>. If we run <code>cargo run -- --foo</code>, then it will work fine. <code>--</code> here is a special argument that changes how Cargo (or npm) interprets the rest of its arguments.</p>
<p>What does the shell do with <code>--</code>? Hopefully the answer is obvious: nothing. This is not a metacharacter. Using <code>--</code> is just a convention used by many programs to change how they interpret their arguments; the shell doesn't care about it.</p>
<h2 id="example-2-escaping-quotes">Example 2: Escaping quotes</h2>
<p>If you want to pass an argument that actually contains a quote, you can escape it with the other type of quote. That is:</p>
<pre style="background-color:#383838;color:#e6e1dc;"><code><span>$ echo &#39;The &quot;quick&quot; brown fox&#39;
</span><span>The &quot;quick&quot; brown fox
</span><span>$ echo &quot;The &#39;quick&#39; brown fox&quot;
</span><span>The &#39;quick&#39; brown fox
</span></code></pre>
<p>If you want to include both kinds of quotes, you could do this:</p>
<pre style="background-color:#383838;color:#e6e1dc;"><code><span>$ echo &quot;The &#39;quick&#39; brown \&quot;fox\&quot;&quot;
</span></code></pre>
<p>But, as mentioned before, it's better to use single quotes by default. The problem is that you can't escape single quotes with a backslash in bash and zsh (you can in fish, but let's ignore that). So, if you want to pass a parameter that contains both double quotes and single quotes <em>and</em> you want to use single quotes for most of it, you have to do this:</p>
<pre style="background-color:#383838;color:#e6e1dc;"><code><span>$ echo &#39;The &#39;&quot;&#39;&quot;&#39;quick&#39;&quot;&#39;&quot;&#39; brown &quot;fox&quot;&#39;
</span><span>The &#39;quick&#39; brown &quot;fox&quot;
</span></code></pre>
<p>The key to understand this monstrosity is that you can concatenate quotes strings. All of these are equivalent:</p>
<pre style="background-color:#383838;color:#e6e1dc;"><code><span>$ echo foobarbaz
</span><span>foobarbaz
</span><span>$ echo &quot;foo&quot;&quot;bar&quot;&quot;baz&quot;
</span><span>foobarbaz
</span><span>$ echo &#39;foo&#39;&quot;bar&quot;&#39;baz&#39;
</span><span>foobarbaz
</span></code></pre>
<p>If that makes sense, and if you squint hard enough, then you can understand the previous example. Here it is again, which each part in a different line:</p>
<pre style="background-color:#383838;color:#e6e1dc;"><code><span>$ echo &#39;The &#39;\
</span><span>&gt; &quot;&#39;&quot;\
</span><span>&gt; &#39;quick&#39;\
</span><span>&gt; &quot;&#39;&quot;\
</span><span>&gt; &#39; brown &quot;fox&quot;&#39;
</span><span>The &#39;quick&#39; brown &quot;fox&quot;
</span></code></pre>
<p>For a good, alternative explanation of this, check <a href="https://stackoverflow.com/a/1250279/3055448">this answer</a> on StackOverflow.</p>
<h2 id="example-3-conditions-in-bash-programming">Example 3: Conditions in bash programming</h2>
<p>So far everything we've seen is related to running programs. But the language interpreted by shells like bash is pretty much a full programming language, including things like conditionals. For example, you can do:</p>
<pre data-lang="bash" style="background-color:#383838;color:#e6e1dc;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#cc7833;">if </span><span style="color:#da4939;">[</span><span> 3 </span><span style="font-style:italic;color:#fd971f;">-gt</span><span> 1 </span><span style="color:#da4939;">]
</span><span style="color:#cc7833;">then
</span><span>  </span><span style="color:#da4939;">echo </span><span style="color:#c1be91;">&quot;3 is greater than 1&quot;
</span><span style="color:#cc7833;">else
</span><span>  </span><span style="color:#da4939;">echo </span><span style="color:#c1be91;">&quot;Math is broken&quot;
</span><span style="color:#cc7833;">fi
</span></code></pre>
<p>Now, you might think that the syntax for an <code>if</code> statement is something like this:</p>
<pre style="background-color:#383838;color:#e6e1dc;"><code><span>if [ &lt;conditions&gt; ]
</span><span>then
</span><span>  &lt;true&gt;
</span><span>else
</span><span>  &lt;false&gt;
</span><span>fi
</span></code></pre>
<p>Where <code>&lt;conditions&gt;</code> uses a terrible syntax. But the actual syntax is this:</p>
<pre style="background-color:#383838;color:#e6e1dc;"><code><span>if &lt;command&gt;
</span><span>then
</span><span>  &lt;true&gt;
</span><span>else
</span><span>  &lt;false&gt;
</span><span>fi
</span></code></pre>
<p>Where <code>&lt;true&gt;</code> will be executed if the command exits with a zero status code, and <code>&lt;false&gt;</code> will be executd if the command exits with a non-zero code.</p>
<p>Wait, does that mean that...?</p>
<pre style="background-color:#383838;color:#e6e1dc;"><code><span>$ whereis [
</span><span>[: /usr/bin/[ /usr/share/man/man1/[.1.gz
</span></code></pre>
<p>Yes: <code>[</code> is a program.<sup class="footnote-reference"><a href="#3">3</a></sup> It receives a list of arguments that are interpreted as conditions, and exits with a zero exit code if its arguments evaluate to true, and non-zero otherwise. Actually, <code>[</code> is kind of an alias to the <code>test</code> command.</p>
<pre style="background-color:#383838;color:#e6e1dc;"><code><span>$ test 3 -gt 1
</span><span>$ echo $?
</span><span>0
</span><span>$ test 3 -gt 3
</span><span>$ echo $?
</span><span>1
</span></code></pre>
<p>(Here we are using the <code>$?</code> variable, which contains the exit code of the last command, to check the result of the <code>test</code> command.)</p>
<p>And I said &quot;kind of an alias&quot; because <code>[</code> is not exactly the same as <code>test</code>.</p>
<pre style="background-color:#383838;color:#e6e1dc;"><code><span>$ [ 3 -gt 1
</span><span>bash: [: missing `]&#39;
</span></code></pre>
<p>As you can check by running <code>man test</code>, <code>[</code> is pretty much the same as <code>test</code>, except that it requires a <code>]</code> as its last argument.</p>
<p>Fun stuff.</p>
<h1 id="clarifications">Clarifications</h1>
<p>There are a lot of simplifications in this article. Some of them are there to make the explanation easier to understand, and some of them are due to my own ignorance. This is a list of the ones I'm aware of and that I think are important:</p>
<ul>
<li>Everything here is very UNIX specific. I think the core ideas apply to non-UNIX operating systems, but many of the details are probably different.</li>
<li>I didn't mention system calls at all, even if they are relevant for a more common definition of a shell: &quot;a shell is a program that provides an interface to the operating system&quot;. This is probably a technically better definition, but I wanted to focus on the &quot;interprets requests to run programs&quot; part.</li>
<li>The environment is actually a list of strings, not a dictionary. These strings, by convention, look like <code>key=value</code> and are interpreted as a dictionary by programs and standard libraries.</li>
</ul>
<h1 id="further-reading">Further reading</h1>
<p><a href="https://en.wikipedia.org/wiki/The_Unix_Programming_Environment">The UNIX Programming Environment</a> is a classic. It's a bit dated, but it's a great read anyway.</p>
<p><a href="https://en.wikipedia.org/wiki/Advanced_Programming_in_the_Unix_Environment">Advanced Programming in the UNIX Environment</a> is a more modern and technical book. I haven't read it cover to cover, not even 10% of it, but it's great as a reference.</p>
<h1 id="footnotes">Footnotes</h1>
<div class="footnote-definition" id="1"><sup class="footnote-definition-label">1</sup>
<p>I'm going to use &quot;program&quot; for both &quot;programs&quot; and &quot;processes&quot;. There are a million explanations out there about the difference, so I won't bother here.</p>
</div>
<div class="footnote-definition" id="2"><sup class="footnote-definition-label">2</sup>
<p>There are also many built-in commands that have a program equivalent with the same name. For example, <code>echo</code> is a built-in command in bash, but there is also a <code>/usr/bin/echo</code> program. I'm not completely sure why this is the case, but <a href="https://stackoverflow.com/a/76727697/3055448">one answer</a> seems to be &quot;POSIX&quot;, a topic I won't delve into.</p>
</div>
<div class="footnote-definition" id="3"><sup class="footnote-definition-label">3</sup>
<p>I'm cheating a bit here. <code>[</code> is actually a shell built-in, but there's also a program with the same name and functionality, similar to <code>echo</code>. Check the previous footnote for an explanation.</p>
</div>

        </section>

        

    </article>
</main>



        <footer>
  <div style="display:flex">
    
        <a class="soc" href=https:&#x2F;&#x2F;github.com&#x2F;fvictorio title=GitHub>
            <i data-feather=github></i>
        </a>
    
        <a class="soc" href=https:&#x2F;&#x2F;twitter.com&#x2F;fvictorio_nan title=Twitter>
            <i data-feather=twitter></i>
        </a>
    
        <a class="soc" href=https:&#x2F;&#x2F;goodreads.com&#x2F;fvictorio title=Goodreads>
            <i data-feather=book></i>
        </a>
    
        <a class="soc" href=mailto:victorio.franco@gmail.com title=Email>
            <i data-feather=mail></i>
        </a>
    
  </div>
  <div class="footer-info">
    2024 Â© Franco Victorio | <a
      href="https://github.com/XXXMrG/archie-zola">Archie-Zola Theme</a>
  </div>
</footer>


<script>
    feather.replace();
</script>


    </div>
</body>

</html>
